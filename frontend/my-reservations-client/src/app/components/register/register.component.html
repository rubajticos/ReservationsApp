<div class="alert alert-success" role="alert" [hidden]="!registerSuccess">
  <span>Success! You are registered succesfully!</span>
</div>

<div class="alert alert-danger" role="alert" [hidden]="!registerError">
  <span>Sorry, an error occured. Please try again</span><br>
  <span>{{error}}</span>
</div>

<div class="d-flex flex-row justify-content-center">
  <div class="spinner-border text-primary" role="status" [hidden]="!loading">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<div class="d-flex flex-row justify-content-center">
  <div class="p-2" [hidden]="registerSuccess">
    <form [appMustMatch]="['password', 'confirmPassword']" #registerForm="ngForm">
      <div class="form-group">
        <label for="username">Username</label>
        <input type="text" class="form-control" id="name" placeholder="Enter username" required minlength="4"
          [(ngModel)]="model.userCredentials.username" name="name" #name="ngModel">
        <div *ngIf="name.invalid && (name.dirty || name.touched)" class="alert alert-danger">
          <div *ngIf="name.errors.required">Username is required</div>
          <div *ngIf="name.errors.minlength">Username must be at least 4 characters long</div>
        </div>
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" id="password" placeholder="Enter password" required
          [(ngModel)]="model.userCredentials.password" name="password" #password="ngModel">
        <div *ngIf="password.invalid && (password.dirty || password.touched)" class="alert alert-danger">
          <div *ngIf="password.errors.required">Password is required</div>
          <div *ngIf="password.errors.mustMatch">Passwords must match</div>
        </div>
      </div>
      <div class="form-group">
        <label for="confirmpassword">Confirm password</label>
        <input type="password" class="form-control" id="confirmpassword" placeholder="Confirm password" required
          [(ngModel)]="model.userCredentials.confirmPassword" name="confirmPassword" #confirmPassword="ngModel">
        <div *ngIf="confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched)"
          class="alert alert-danger">
          <div *ngIf="confirmPassword.errors.required">Confirm password is required</div>
          <div *ngIf="confirmPassword.errors.mustMatch">Passwords must match</div>
        </div>
      </div>
      <div class="m-5"></div>
      <div class="form-group">
        <label for="firstName">First Name</label>
        <input type="text" class="form-control" id="firstName" placeholder="Enter first name" required
          [(ngModel)]="model.patient.firstName" name="firstName" #firstName="ngModel">
        <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)" class="alert alert-danger">
          <div *ngIf="confirmPassword.errors.required">First name is required</div>
        </div>
      </div>
      <div class="form-group">
        <label for="lastName">Last Name</label>
        <input type="text" class="form-control" id="lastName" placeholder=" Enter last name" required
          [(ngModel)]="model.patient.lastName" name="lastName" #lastName="ngModel">
        <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)" class="alert alert-danger">
          <div *ngIf="lastName.errors.required">Last name is required</div>
        </div>
      </div>
      <div class="form-group">
        <label for="phone">Phone</label>
        <input type="text" class="form-control" id="phone" placeholder="Enter phone number" required minlength="9"
          maxlength="9" [pattern]="phoneNumberPattern" [(ngModel)]="model.patient.phoneNumber" name="phone"
          #phone="ngModel">
        <div *ngIf="phone.invalid && (phone.dirty || phone.touched)" class="alert alert-danger">
          <div *ngIf="phone.errors.required">Phone is required</div>
          <div *ngIf="phone.errors.pattern">Use only numbers</div>
          <div *ngIf="phone.errors.minlength">Phone must have 9 characters long</div>
        </div>
      </div>
      <div class="form-group">
        <label for="email">E-mail</label>
        <input type="text" class="form-control" id="email" placeholder="Enter e-mail" required email
          [(ngModel)]="model.patient.email" name="email" #email="ngModel">
        <div *ngIf="email.invalid && (email.dirty || email.touched)" class="alert alert-danger">
          <div *ngIf="email.errors.required">E-mail is required</div>
          <div *ngIf="email.errors.email">Invalid e-mail format</div>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="d-flex flex-row justify-content-center">
  <div class="p-2">
    <button type="submit" class="btn btn-primary btn-lg btn-block" [disabled]="!registerForm.form.valid" (click)="onSubmit()">
      Sign Up!
    </button>
  </div>
</div>

<div class="d-flex flex-row justify-content-center">
  <div class="p-2" [hidden]="!registerSuccess">
    <h2>You registered with the following:</h2>
    <div class="d-flex flex-row">
      <div class="p-2 registeredLabel">Username:</div>
      <div class="p-2">{{model.userCredentials.username}}</div>
    </div>
    <div class="d-flex flex-row">
      <div class="p-2 registeredLabel">First name:</div>
      <div class="p-2">{{model.patient.firstName}}</div>
    </div>
    <div class="d-flex flex-row">
      <div class="p-2 registeredLabel">Last name:</div>
      <div class="p-2">{{model.patient.lastName}}</div>
    </div>
    <div class="d-flex flex-row">
      <div class="p-2 registeredLabel">Phone:</div>
      <div class="p-2">{{model.patient.phoneNumber}}</div>
    </div>
    <div class="d-flex flex-row">
      <div class="p-2 registeredLabel">E-mail:</div>
      <div class="p-2">{{model.patient.email}}</div>
    </div>
  </div>
</div>
